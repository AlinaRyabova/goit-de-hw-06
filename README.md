–î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è –¥–æ —Ç–µ–º–∏ ¬´Spark streaming¬ª



–í—ñ—Ç–∞—é! –Ø–∫ –Ω–∞—Å—Ç—Äi–π? –°–ø–æ–¥i–≤–∞—é—Å—å, —â–æ –≤–∏ –∑ –Ω–µ—Ç–µ—Ä–øi–Ω–Ω—è–º –æ—á—ñ–∫—É—î—Ç–µ –Ω–∞ –Ω–æ–≤–∏–π —á–µ–ª–µ–Ω–¥–∂ üòâ



–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—à—É –¥–æ –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è, –≤–∏–∫–æ–Ω–∞–≤—à–∏ —è–∫–µ, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–∏—Ç–∏ —Å–≤–æ—ó –Ω–∞–≤–∏—á–∫–∏ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è Apache Kafka.



–ó–∞–≤–¥–∞–Ω–Ω—è —î —Å—Ö–æ–∂–∏–º –Ω–∞ —Ç–µ, —â–æ –±—É–ª–æ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ç–µ–º—ñ, –∞–ª–µ –Ω–∞–±–∞–≥–∞—Ç–æ —Ü—ñ–∫–∞–≤—ñ—à–µ! üòä

–°—å–æ–≥–æ–¥–Ω—ñ –≤–∏ –±—É–¥–µ—Ç–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ç–∏–ø–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –∑–Ω–∞—á–µ–Ω—å –¥–∞–Ω–∏—Ö –Üo–¢ –ø—Ä–∏–ª–∞–¥—ñ–≤.



–£ —Ü—å–æ–º—É –¥–æ–º–∞—à–Ω—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ –≤–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–ª—è –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö –∑ Kafka-—Ç–æ–ø—ñ–∫—É, —â–æ –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è —Å–µ–Ω—Å–æ—Ä–∞–º–∏, —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É, —â–æ –±—É–¥–µ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ —Ç–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –∞–ª–µ—Ä—Ç–∏ –≤ alert-Kafka-—Ç–æ–ø—ñ–∫ –∑–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤.

üëì –ê–ª–µ—Ä—Ç ‚Äî –≤—ñ–¥ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ–≥–æ —Å–ª–æ–≤–∞ alert ‚Äî —Ç—Ä–∏–≤–æ–≥–∞. –î–∞–Ω—ñ, —â–æ –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –º–µ–∂—ñ –¥–æ–ø—É—Å—Ç–∏–º–∏—Ö –∑–Ω–∞—á–µ–Ω—å, –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è –∞–ª–µ—Ä—Ç–∞–º–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —á–∏ –≤–æ–ª–æ–≥—ñ—Å—Ç—å –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –¥–æ–ø—É—Å—Ç–∏–º—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.




–ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è



1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö:

–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ ‚Äî —Ü–µ –¥–∞–Ω—ñ –∑ Kafka-—Ç–æ–ø—ñ–∫—É, —Ç–∞–∫—ñ —Å–∞–º—ñ, —è–∫ —ñ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –¥–æ–º–∞—à–Ω—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ. –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö, —â–æ –º—ñ—Å—Ç–∏—Ç—å id, temperature , humidity, timestamp . –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ä–∞–Ω—ñ—à–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–π –≤–∞–º–∏ —Å–∫—Ä–∏–ø—Ç —Ç–∞ —Ç–æ–ø—ñ–∫.



2. –ê–≥—Ä–µ–≥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö:

–ó—á–∏—Ç–∞–π—Ç–µ –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö, —â–æ –≤–∏ –∑–≥–µ–Ω–µ—Ä—É–≤–∞–ª–∏ –≤ –ø–µ—Ä—à–æ–º—É –ø—É–Ω–∫—Ç—ñ. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Sliding window, —â–æ –º–∞—î –¥–æ–≤–∂–∏–Ω—É 1 —Ö–≤–∏–ª–∏–Ω—É, sliding_interval ‚Äî 30 —Å–µ–∫—É–Ω–¥, —Ç–∞ watermark duration ‚Äî 10 —Å–µ–∫—É–Ω–¥, –∑–Ω–∞–π–¥—ñ—Ç—å —Å–µ—Ä–µ–¥–Ω—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Ç–∞ –≤–æ–ª–æ–≥—ñ—Å—Ç—å.



3. –ó–Ω–∞–π–æ–º—Å—Ç–≤–æ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∞–ª–µ—Ä—Ç—ñ–≤:

–í–∞—à –Ω–∞—á–∞–ª—å–Ω–∏–∫ –ª—é–±–∏—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó –∞–ª–µ—Ä—Ç—ñ–≤. –¢–æ–º—É, —â–æ–± –¥–µ–ø–ª–æ—ó—Ç–∏ –∫–æ–¥ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–ª–µ—Ä—Ç—ñ–≤ –≤–∫–∞–∑–∞–Ω—ñ –≤ —Ñ–∞–π–ª—ñ:

alerts_conditions.csv

–§–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ —Ç–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ –π –≤–æ–ª–æ–≥–æ—Å—Ç—ñ, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞ –∫–æ–¥ –∞–ª–µ—Ä—Ç—É. –ó–Ω–∞—á–µ–Ω–Ω—è -999,-999 –≤–∫–∞–∑—É—é—Ç—å, —â–æ –≤–æ–Ω–∏ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ü—å–æ–≥–æ –∞–ª–µ—Ä—Ç—É.

–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ –¥–∞–Ω—ñ –≤ —Ñ–∞–π–ª—ñ. –í–æ–Ω–∏ –º–∞—é—Ç—å –±—É—Ç–∏ —ñ–Ω—Ç—É—ó—Ç–∏–≤–Ω–æ –∑—Ä–æ–∑—É–º—ñ–ª—ñ. –í–∏ –º–∞—î—Ç–µ –∑—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ñ–∞–π–ª—É —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤.



4. –ü–æ–±—É–¥–æ–≤–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤:

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –≤–∏ –∑–Ω–∞–π—à–ª–∏ —Å–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏, —á–∏ –ø—ñ–¥–ø–∞–¥–∞—é—Ç—å –≤–æ–Ω–∏ –ø—ñ–¥ –∫—Ä–∏—Ç–µ—Ä—ñ—ó —É —Ñ–∞–π–ª—ñ (–ø—ñ–¥–∫–∞–∑–∫–∞: –≤–∏–∫–æ–Ω–∞–π—Ç–µ cross join —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é).



5. –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É Kafka-—Ç–æ–ø—ñ–∫:

–û—Ç—Ä–∏–º–∞–Ω—ñ –∞–ª–µ—Ä—Ç–∏ –∑–∞–ø–∏—à—ñ—Ç—å —É –≤–∏—Ö—ñ–¥–Ω–∏–π Kafka-—Ç–æ–ø—ñ–∫.
